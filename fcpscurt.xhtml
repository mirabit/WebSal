<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet href="../webgestext/xsltforms/xsltforms.xsl" type="text/xsl"?>
<!--<?xml-stylesheet href="../xsltforms/xsltforms.xsl" type="text/xsl"?>-->
<!--<?xsltforms-options lang="ro" debug="yes"?>-->
<?css-conversion no?>

<html
 xmlns="http://www.w3.org/1999/xhtml"
 xmlns:xforms="http://www.w3.org/2002/xforms"
 xmlns:xsd="http://www.w3.org/2001/XMLSchema"
 xmlns:ev="http://www.w3.org/2001/xml-events"
 xml:lang="en">
<head>

	<title>FOAIE CALCUL PREZENŢĂ fcpscurt</title>  
	<link rel="stylesheet" href="selekt.css"></link>

	<style type="text/css">

		@namespace xforms url("http://www.w3.org/2002/xforms");
	
	</style>
	<style type="text/css">


	<!-- Dialog COCM  in -->
		#comed { width: 80em;height: 65em;}
		.row * {
		   display:inline;			  
		}
		#codihna{ width: 78em;height: 43em;}
		.row * {
		   display:inline;			  
		}
	<!-- Dialog COCM  end -->

		#editPontaj { width: 81em; height: 47em; background:#E3E3E3;}
		div#editPontaj.xforms-dialog {
			width				: 81em;
			height				: 47em;
			border				: 1px solid black;
			
		}
		
		.row * {
		   display:inline;			  
		}

	#OreZiNoi { width: 20em;height: 5em;}
		.row * {
		   display:inline;			  
		}

		.cpont {vertical-align:top;border-width:0.1mm;border-style:solid; padding:1px;
		width:15px;font-size:25px;font-weight:bold; color:#000000;background-color:#C9C9C9;} 
		.cpont1 {vertical-align:top;border-width:0.1mm;border-style:solid; padding:1px;
		width:15px;font-size:14px; color:#000000;background-color:#C2CCD0;}
		.valpont .xf-value {width:12mm;border-width:0.1mm; border-style:solid;text-align:right;background:#F6FCFF;}
        .tdziles {width:10.9em;height:3.4em;border-width:0.0px; border-style:solid;text-align:right;background:#F6FCFF;}
        .orezidr .xf-value {text-align:right;}  
	.leftt{padding:15px 0px 15px 60px;}
	</style>

	<script type="text/javascript" src="loadSal.js"/>
	<script type="text/javascript" src="modalwin.js"/>
	
	<script type="text/javascript" src="../webgestext/jq/jquery.min.js" ></script>
	
	<xforms:model id="SAL" version="1.1">

        <xforms:instance id="sal">
			<DATE xmlns="">
	   			<d/>																						
			</DATE> 
	 	</xforms:instance>             
        <xforms:instance id="sapt" resource="sapt.xml" />
		<xforms:instance id="tmp">
			<DATE xmlns="">
				<marca/>
				<AnLunaDL/>	
				<contor>0</contor>
				<Ore tip="">0</Ore>
				<NrPI/>	
				<Luna AnLuna="" NrZlucruL=""/> 					
				<Venit_Brut/>
				<OreZi tip="Lucru">876</OreZi>
				<nrzi/>	
			</DATE> 
		</xforms:instance>	           
		<xforms:instance id="ore">
			<DATE xmlns="">
				<Ziua/>
				<OreZi tip="Lucru" simbol="L" totalIn="0" totalSf="0" oreIn="0">0</OreZi>
				<OreZi tip="COdihna" simbol="CO" totalIn="0" totalSf="0" oreIn="0">0</OreZi>
				<OreZi tip="CMedical" simbol="CM" totalIn="0" totalSf="0" oreIn="0">0</OreZi>
				<OreZi tip="Invoire" simbol="I" totalIn="0" totalSf="0" oreIn="0">0</OreZi>
				<OreZi tip="Nemotivat" simbol="N" totalIn="0" totalSf="0" oreIn="0">0</OreZi>
				<OreZi tip="S50" simbol="S50" totalIn="0" totalSf="0" oreIn="0">0</OreZi>
				<OreZi tip="CMatern" simbol="CMat" totalIn="0" totalSf="0" oreIn="0">0</OreZi>
			</DATE>
		</xforms:instance> 
        <xforms:instance id="dg" resource="dategen.xml" />
        <!--<xforms:instance id="sablon" resource="salsablon.xml" />-->          
        			
		<xforms:submission id="s01" method="put" action="sal.xml" ref="/SAL"/>
		<xforms:bind nodeset="instance('sal')/Date_operare/DataP" type="xsd:date" />
		<!--<xforms:bind id="d" required="true()" type="xsd:date" nodeset="instance('sal')/Date_operare/DataP" />
		<xforms:bind nodeset="instance('sal')/Date_operare/NrSal" calculate="count(/SAL/Personal/Salariat)"/>-->
		<xforms:bind nodeset="instance('sal')/Personal/Salariat/@Nume" required="true()"/>
	
		<!--<xforms:bind nodeset="instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/Salariat[@id=instance('sal')/Personal/Salariat/@id]/Deduceri" calculate="instance('dg')/Deduceri/DeduceriPL[@id=instance('sal')/Personal/Salariat/@Copii_intretinere]/Deducere[@VenitMin &lt; instance('sal')/Personal/Salariat/Contract/Salariu &lt; VenitMax]"/>
		<xforms:bind nodeset="instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/Salariat/Deduceri" calculate="instance('dg')/Deduceri/DeduceriPL[@id = instance('sal')/Personal/Salariat[@id = ./@id]/@Copii_intretinere]/Deducere[@VenitMin &lt; instance('sal')/Personal/Salariat/Contract/Salariu]"/>-->

		<xforms:instance id="como" resource="cocm.xml"/>

		<xforms:bind nodeset="/CO/ConcediuM/TVU6L" 
		calculate="/CO/ConcediuM/Luna1CM + /CO/ConcediuM/Luna2CM + /CO/ConcediuM/Luna3CM + /CO/ConcediuM/Luna4CM + /CO/ConcediuM/Luna5CM + /CO/ConcediuM/Luna6CM"/>

		<xforms:bind nodeset="/CO/ConcediuM/TZU6L" 
		calculate="/CO/ConcediuM/ZileL1CM + /CO/ConcediuM/ZileL2CM + /CO/ConcediuM/ZileL3CM + /CO/ConcediuM/ZileL4CM + /CO/ConcediuM/ZileL5CM + /CO/ConcediuM/ZileL6CM"/>

		<xforms:bind nodeset="/CO/ConcediuM/MedV6L" 
		calculate="/CO/ConcediuM/TVU6L div (/CO/ConcediuM/TZU6L)"/>

		<xforms:bind nodeset="/CO/ConcediuM/IndemCMBr" 
		calculate="round((/CO/ConcediuM/MedV6L * /CO/ConcediuM/ProcCM */CO/ConcediuM/NrZCM) div 100)"/>

		<xforms:bind nodeset="/CO/ConcediuM/ValCASAt" 
		calculate="round((/CO/ConcediuM/SalMinEC * /CO/ConcediuM/CASAt) div 100)"/>

		<xforms:bind nodeset="/CO/ConcediuM/IndemPlCM" 
		calculate="/CO/ConcediuM/IndemCMBr - /CO/ConcediuM/ValCASAt "/>

		<xforms:bind nodeset="/CO/ConcediuM/NrZCM"
		calculate="/CO/Certificat/ZileCM"/>

		<xforms:bind nodeset="instance('como')/CO/Certificat/DataAcord" type="xsd:date" />
		<xforms:bind nodeset="instance('como')/CO/Certificat/DataDela" type="xsd:date" />
		<xforms:bind nodeset="instance('como')/CO/Certificat/DataPanala" type="xsd:date" />
		<xforms:bind required="true()" type="xsd:date" nodeset="instance('sal')/Date_operare/Data"/>
		<xforms:bind nodeset="instance('sal')/Date_operare/Data" type="xsd:date" />
	</xforms:model>

	<script type="text/javascript">
			
			function creCTP() {
				//citesc luna an din instanta 
				var model = document.getElementById("SAL").xfElement;
				var inst = model.getInstanceDocument("sal");
				//var year=inst.getElementsByTagName("An")[0].childNodes[0].nodeValue;
				//var month=inst.getElementsByTagName("Luna")[0].getAttribute("nr");
				var yearmonth=inst.getElementsByTagName("LunaLucru")[0].childNodes[0].nodeValue;
				var year=yearmonth.substr(0,4);
				var month=yearmonth.substr(4);
				//alert(month);
				//creez array cu primele 7 zile din luna ( ca si nr zi din saptamana) 
				var l1=new Array();
				for(var i=1; i &lt; 8; i++){
					d = new Date(year,month-1,i);
					l1[i-1]=d.getDay();
				}				
				//creere cap tabel pontaj
				var zilesapt=["Duminică","Luni____","Marți___","Miercuri","Joi_____","Vineri__","Sâmbătă"];
				var lct=document.getElementById("ctpontaj");
				if ( lct.hasChildNodes() )
				{
					while ( lct.childNodes.length >= 1 )
					{
						lct.removeChild( lct.firstChild );       
					} 
				}				
				for(var i=0; i &lt; 7; i++){
					var col=document.createElement("td");
					var idx=l1[i];
					var nume=zilesapt[idx];
					col.appendChild(document.createTextNode(nume));
					lct.appendChild(col);
				}
			}
		
		</script>	
		
	</head>

	<body bgcolor="#F3F3F3" text="#000000" rightmargin="80" topmargin="40" onload="loadInstFromLocal('sal');">
	
	<xforms:switch>
		<xforms:case id="alegeLuna" >
			<div id="background2" align="center" style="width:90%">
				<br/>
				<div>
					<span style="color:#000000;padding:0.2em; ">Alege o lună existentă </span>				
					<span style="color:#000000;padding:0.2em; ">
						<xforms:select1 class="Ztd1" ref="instance('sal')/LunaLucru">
							<xforms:itemset nodeset="instance('sal')/DateLunare/Luna/@AnLuna">
								<xforms:label ref="."/>
								<xforms:value ref="."/>
							</xforms:itemset>								                         
						</xforms:select1>
					</span>
					<xforms:trigger appearance="minimal">
						<xforms:label class="medium button greenn">
							<div> Intrare în pontaj </div>
						</xforms:label>
						<xforms:action ev:event="DOMActivate">
							<xforms:load resource="javascript:iniPontajSort()"/>
							<xforms:toggle case="casePontaj"/>
						</xforms:action>						
					</xforms:trigger>						
				</div>
				<br/>
				<div>
					<span style="color:#000000;padding:0.2em; ">Creere lună nouă </span>
					<xforms:input ref="instance('sal')/Date_operare/Data"></xforms:input>					
					<xforms:trigger appearance="minimal">
						<xforms:label class="medium button greenn">
							<div> Intrare în pontaj </div>
						</xforms:label>
						<xforms:action ev:event="DOMActivate">
							<xforms:setvalue ref="instance('sal')/LunaLucru" value="concat(substring(instance('sal')/Date_operare/Data,1,4) , substring(instance('sal')/Date_operare/Data,6,2))"/>
						</xforms:action>						
						<xforms:action ev:event="DOMActivate" if="not(not(concat(substring(instance('sal')/Date_operare/Data,1,4) , substring(instance('sal')/Date_operare/Data,6,2)) = instance('sal')/DateLunare/Luna/@AnLuna))">
							<xforms:message>Luna există deja</xforms:message>
						</xforms:action>						
						<xforms:action ev:event="DOMActivate" if="not(concat(substring(instance('sal')/Date_operare/Data,1,4) , substring(instance('sal')/Date_operare/Data,6,2)) = instance('sal')/DateLunare/Luna/@AnLuna)">
							<xforms:setvalue ref="instance('tmp')/Luna/@AnLuna" value="instance('sal')/LunaLucru"/>
							<!-- Aici trebuie setat și @NrZlucruL - în javascript-->											
							<xforms:insert origin="instance('tmp')/Luna" context="instance('sal')/DateLunare" nodeset="/Luna"/>
							<xforms:load resource="javascript:iniPontajSort()"/>							
							<xforms:toggle case="casePontaj"/>
						</xforms:action>						
					</xforms:trigger>
				</div>	
				<br/>
				<div>
					<span style="color:#000000;padding:0.2em; ">Șterge luna  </span>				
					<span style="color:#000000;padding:0.2em; ">
						<xforms:select1 class="Ztd1" ref="instance('sal')/LunaLucru">
							<xforms:itemset nodeset="instance('sal')/DateLunare/Luna/@AnLuna">
								<xforms:label ref="."/>
								<xforms:value ref="."/>
							</xforms:itemset>								                         
						</xforms:select1>
					</span>
					<xforms:trigger appearance="minimal">
						<xforms:label class="medium button red">
							<div> Șterge </div>
						</xforms:label>
						<xforms:action ev:event="DOMActivate">
							<xforms:show dialog="ConfirmDelete"/>
						</xforms:action>						
					</xforms:trigger>						
				</div>
				<br/><br/>								  
	            <div>
                    <!--<xforms:trigger appearance="minimal">
                    <xforms:label class="Sterg"> Intrare la pontaj </xforms:label>
                        <xforms:action ev:event="DOMActivate">
                        	<xforms:toggle case="casePontaj"/>
                            <xforms:load resource="javascript:saveDataLocal('sal')"/>
                        </xforms:action>
                    </xforms:trigger>-->

                    <xforms:trigger>
                        <xforms:label class="Home"> Renunță </xforms:label>
                        <xforms:action ev:event="DOMActivate">
                        	<xforms:load resource="index01.xhtml"/>
                        </xforms:action>	
                    </xforms:trigger>
	            </div>
		    </div>		
		</xforms:case>
		<xforms:case id="casePontaj" >
			
		<div style="width:100%">
			<div><h3 align="center"> PONTAJ </h3></div>
			<table border="0" width="100%">                                                                     
				<table align="left">
					<tr>
						<td colspan="4">
							<label><i>Firma </i></label>
							<b class="nzo1">							
							<xforms:output value="instance('sal')/Date_firma/Prefix" class="val3"/>
							<xforms:output value="instance('sal')/Date_firma/Firma" class="val2"/>
							<xforms:output value="instance('sal')/Date_firma/Sufix" class="val3"/></b>
						</td>
					</tr>
					<tr>
						<td>
							<label><i>Anul </i></label>
							<b class="nzo1"><xforms:output value="substring(instance('sal')/LunaLucru,1,4)" class="val1Z"/></b>
						</td>
						<td>
							<label><i>Luna </i></label>
							<b class="nzo1"><xforms:output value="substring(instance('sal')/LunaLucru,5,2)" class="val1"/></b>
						</td>
						<td>
							<label>Nr Zile Lucrătoare :
							<xforms:trigger appearance="minimal">
								<xforms:hint class="afisare">
								<p>Acest câmp este editabil în funcţie de zilele libere acordate în luna de lucru conform legii</p>
								</xforms:hint>
							</xforms:trigger>
							</label><b class="nzoin">
							<xforms:input ref="instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/@NrZlucruL" /></b>
						</td>
						<td>
							<label>Ore in Conditii normale de munca : </label><b class="nzo">
							<xforms:output value="instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/@NrZlucruL * 8"/></b>	
						</td>
						<!--<td>
							<label>Alege altă lună </label>
							<xforms:select1 class="Ztd1" ref="instance('sal')/LunaLucru">
								<xforms:itemset nodeset="instance('sal')/DateLunare/Luna/@AnLuna">
									<xforms:label ref="."/>
									<xforms:value ref="."/>
								</xforms:itemset>
					                        
						 	</xforms:select1>
						</td>	-->						
					</tr>
				</table>
			</table>
		</div>

        <div align="left" style="width:100%">    
            <div align="center" style="width:90%">

        <table class="tab" border="0" cellspacing="6" cellpadding="10" width="100%">  
            <hr align="center" color="#D7D5D8" width="100%"/> 
                <table class="tab" border="0" cellspacing="6" cellpadding="10" width="100%"> 
                    <tr>
                        <th class="Fnrc"> Nr. Crt</th>
                        <th class="Fprob">Pontaj salariat
						<xforms:trigger appearance="minimal">
							<xforms:hint class="afisare">
							<p>Click pentru modificare date pontaj pe butonul ( Pontej )</p>
							</xforms:hint>
						</xforms:trigger></th>
						<!--<th class="Fprob">Nr. Crt / Pontaj salariat</th>-->
                        <th class="Fpro1">Nume</th> 
                        <th class="Fpro1">Prenume</th> 
                        <th class="Fpro1">Funcţia</th>	
                        <th class="Fpro">Total Ore lucrate 1-15</th>
                        <th class="Fpro">Total Zile_1-15</th>	
                        <th class="Fpro">Total Ore lucrate luna 1-31</th>
                        <th class="Fpro">Total Zile_1-31</th>
                    </tr>
				</table>  
                <table class="tab" border="0" cellspacing="4" cellpadding="10" width="100%"> 
                    <table>
                        <xforms:repeat nodeset="/SAL/Personal/Salariat[Contract/StareCurentaId='ContractStareActiv']" id="repeatRow"> 
                            <tr id="SAL">
                                <td class="Ftnrt"><xforms:output class="Fvaln" value="position()"/>
                                </td>

                                <td class="Ftnmp">
                                    <xforms:trigger appearance="minimal">
										<xforms:label class="small button greenn">Pontaj</xforms:label>
																		
										<!--<xforms:hint>Clik pentru pontaj salariat</xforms:hint>-->
										<xforms:setvalue ref="instance('tmp')/marca" value="current()/@id" ev:event="DOMActivate"/>
										<xforms:setvalue ref="instance('tmp')/NrPI" value="if(current()/@Copii_intretinere &lt; 4 , current()/@Copii_intretinere , 4)" ev:event="DOMActivate"/>
										<!--<xforms:setvalue ref="instance('tmp')/AnLunaDL" value="current()/@id" ev:event="DOMActivate"/>
										
										<xforms:action ev:event="DOMActivate" if="not(instance('sal')/LunaLucru = instance('sal')/DateLunare/Luna/@AnLuna[/Salariat[@id = current()/@id]])">-->
										<xforms:action ev:event="DOMActivate" if="not(instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/Salariat[@id = current()/@id])">
                                			<xforms:show dialog="lipsaLuna"/>
                            			</xforms:action>							
										<xforms:action ev:event="DOMActivate">
											
                                			<xforms:show dialog="editPontaj"/>
                                			<xforms:load resource="javascript:creCTP()"/>
                            			</xforms:action><!-- -->
                                    </xforms:trigger>
                                </td>
                                <td class="Ftnmf"><xforms:output class="Fval" value="@Nume"/></td> 
                                <td class="Ftnmf"><xforms:output class="Fval" value="@Prenume"/></td> 
                                <td class="Ftnmf"><xforms:output class="Fval" value="@Functia"/></td>
                                <td class="Ftnrs"><xforms:output class="Fval1" value="sum(instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/Salariat[@id=current()/@id]/Sapt/Zile/Ziua[@nr &lt; '16']/OreZi[@tip='Lucru'])"/></td>
                                <td class="Ftnrs"><xforms:output class="Fval1" value="Zile_Lucrate1_15"/>-</td>
                                <td class="Ftnrs"><xforms:output class="Fval1" value="sum(instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/Salariat[@id=current()/@id]/Sapt/Zile/Ziua/OreZi[@tip='Lucru'])"/></td>
                                <td class="Ftnrs"><xforms:output class="Fval1" value="Zile_Lucrate1_31"/>-</td>
                            </tr>  
                        </xforms:repeat>
                    </table>
				</table>
            	<hr align="center" color="#D7D5D8" width="100%" />
            </table>
   
				</div>

		<br/>

        <div align="center" style="width:97%">

	<table class="Foond" border="0" cellspacing="3" cellpadding="2" width="100%">
			<tr>
				<td>
					<xforms:trigger appearance="minimal" ev:event="DOMActivate"> 									 
						<xforms:label class="medium button white">&#171; Înapoi la pagina principală &#171;</xforms:label> 
						<xforms:hint>Înapoi la pagina principală</xforms:hint>
						<xforms:load resource="index01.xhtml" ev:event="DOMActivate"/>
					</xforms:trigger>

					<!--<xforms:trigger appearance="minimal" id="intr">
						<xforms:label  class="medium button orange">
							<i>&#164; Salvează &#164;</i>
						</xforms:label>  
						<xforms:hint>Salvează datele introduse/modificate</xforms:hint>	
							<xforms:action ev:event="DOMActivate">					
							<xforms:load resource="javascript:saveDataLocal('sal')"/>					
						</xforms:action>
					</xforms:trigger> -->
					
					<xforms:trigger appearance="minimal">
						<xforms:label class="medium button back"> &#171; Alege altă lună &#171;</xforms:label>
						<xforms:toggle case="alegeLuna" ev:event="DOMActivate"/>	
					</xforms:trigger>					

					<xforms:trigger appearance="minimal" ev:event="DOMActivate">
						<xforms:label class="medium button blue">&#187; Next &#187; Stat salarii &#187;</xforms:label>
						<xforms:hint>Înapoi la pagina principală</xforms:hint>
						<xforms:load resource="sal01.xhtml" ev:event="DOMActivate"/>	
					</xforms:trigger>

					<xforms:trigger appearance="minimal" ev:event="DOMActivate">
						<xforms:label class="medium button back"> &#171; Back &#171; Liste Personal &#171;</xforms:label>
						<xforms:hint>Înapoi la Liste Personal</xforms:hint>
						<xforms:load resource="ldpscurt.xhtml" ev:event="DOMActivate"/>	
					</xforms:trigger>
			</td>
		</tr>         
	</table>

         </div> 
	</div>
        <br/>
        
       </xforms:case> 
    </xforms:switch>

	<xforms:dialog id="editPontaj">

	<xforms:group nodeset="Salariat" ref="instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/Salariat[@id=instance('tmp')/marca]">   

	<div id="foaiep" align="center" style="width:98%">	 
        <table align="center" border="0" width="98%">
            <tr>
            	<td colspan="5" align="center" >
					<label> Salariat: </label>
            		<b class="nzop"><xforms:output value="instance('sal')/Personal/Salariat[@id=instance('tmp')/marca]/@Nume" class="valdf2"/></b>
            		<xforms:label> </xforms:label>
            		<b class="nzop"><xforms:output value="instance('sal')/Personal/Salariat[@id=instance('tmp')/marca]/@Prenume" class="valdf2"/></b>
<!--<label> Copii in intretinere: </label>
<b class="nzop"><xforms:output value="instance('sal')/Personal/Salariat[@id=instance('tmp')/marca]/@Copii_intretinere" class="valdf2"/></b>-->
					<label> Luna: </label>
					<b class="nzop"><xforms:output value="substring(instance('sal')/LunaLucru,5,2)" class="val1"/></b>
					<label> An: </label>
					<b class="nzop"><xforms:output value="substring(instance('sal')/LunaLucru,1,4)" class="val1"/></b>
							
            		<xforms:group nodeset="Contract" ref="instance('sal')/Personal/Salariat[@id=instance('tmp')/marca]/Contract">    
        		 		 <label> Norma ore/zi: </label><b class="nzop"><xforms:output value="TimpMuncaNorma" class="valdf2"/></b>
        		 		 <label> Norma ore/lună: </label><b class="nzop"><xforms:output value="TimpMuncaNorma * instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/@NrZlucruL" class="valdf2"/></b>  
		    			 <label> Salariu: </label><b class="nzop"><xforms:output value="Salariu"/></b>
		    			 <label> Tarif orar: </label><b class="nzop"><xforms:output value="if(Salariu/@fix='da', Salariu div (TimpMuncaNorma * instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/@NrZlucruL), TarifSalOra)"/></b>
		    			 <label> Tip tarif: </label><b class="nzop"><xforms:output value="if(Salariu/@fix='da', 'salariu fix', 'orar fix')"/></b>
        			</xforms:group> 
        			<span> Alege tipul de ore, pentru toate zilele lucrătoare din lună
						<xforms:select1 ref="instance('tmp')/OreZi/@tip">
							<xforms:itemset nodeset="instance('ore')/OreZi">
								<xforms:label ref="@tip"/>
								<xforms:value ref="@tip"/>
							</xforms:itemset>
						</xforms:select1>
						<xforms:trigger >										
							<xforms:label>Actualizează</xforms:label> 						
							<xforms:action ev:event="DOMActivate">
								<xforms:delete nodeset="instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/Salariat[@id=instance('tmp')/marca]/Sapt/Zile/Ziua[@tip='l']/OreZi"/>
								<xforms:setvalue ref="instance('tmp')/OreZi" value="instance('sal')/Personal/Salariat[@id=instance('tmp')/marca]/Contract/TimpMuncaNorma"/>
								<xforms:setvalue ref="instance('tmp')/contor" value="1"/>
							</xforms:action>
							<xforms:action ev:event="DOMActivate" while="instance('tmp')/contor &lt; count(instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/Salariat[@id=instance('tmp')/marca]/Sapt/Zile/Ziua)">
									<xforms:setvalue ref="instance('tmp')/nrzi" value="instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/Salariat[@id=instance('tmp')/marca]/Sapt/Zile/Ziua[number(instance('tmp')/contor)]"/>							
									<xforms:insert origin="instance('tmp')/OreZi" context="instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/Salariat[@id=instance('tmp')/marca]/Sapt/Zile/Ziua[@tip='l'][@nr=instance('tmp')/contor]" nodeset="/OreZi"/>
									<xforms:setvalue ref="instance('tmp')/contor" value=". + 1"/>								
							</xforms:action>
							
							<!-- plus totaluri preluate dela actualizare ore  -->
							<xforms:action ev:event="DOMActivate"> 				        							
								<xforms:delete nodeset="TotalPontaj/Ore"/><!----> 
								<xforms:setvalue ref="TotalPontaj/OreL1-15" value="sum(../../Sapt/Zile/Ziua[@nr &lt; '16']/OreZi[@tip='Lucru'])"/>
								<xforms:setvalue ref="instance('tmp')/contor" value="1"/>	
							</xforms:action>
							<xforms:action ev:event="DOMActivate" while="instance('tmp')/contor &lt; count(instance('ore')/OreZi) + 1"> 
								<xforms:setvalue ref="instance('tmp')/Ore/@tip" value="instance('ore')/OreZi[number(instance('tmp')/contor)]/@tip"/>
								<xforms:setvalue ref="instance('tmp')/Ore" value="sum(instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/Salariat[@id=instance('tmp')/marca]/Sapt/Zile/Ziua/OreZi[@tip = instance('ore')/OreZi[number(instance('tmp')/contor)]/@tip])"/>												
								<xforms:action ev:event="DOMActivate" if="instance('tmp')/Ore &gt; 0 ">
									<xforms:insert origin="instance('tmp')/Ore" context="TotalPontaj" nodeset="/Ore"/>		        	
								</xforms:action>									
								<xforms:setvalue ref="instance('tmp')/contor" value=". + 1"/> 	
							</xforms:action> 
						</xforms:trigger >																     			
        			</span>        		
            	</td>            	
        	</tr>
            <tr><td>
		
		<table border="0" width="90%" style="width:90%; border:1px solid black;"> 
        	<tr id="ctpontaj" class="tdziles"></tr>  
        	<tr><td colspan="7" align="center" >

        	<!--<tr><td><table>  --> 
         	
			<xforms:repeat nodeset="Sapt" id="repeatSapt" >
			<table align="left">	
				<tr align="center">			
			
					<!--<xforms:output ref="@nr" /> -->
			<xforms:repeat nodeset="Zile/Ziua" id="repeatZis" >			
				<table class="tdziles" ><tr align="center">
					<td>										
						<xforms:trigger >										
							<xforms:label><xforms:output ref="@nr" /></xforms:label> 
					        <xforms:action ev:event="DOMActivate">					        						        	
					        	<xforms:setvalue ref="instance('ore')/Ziua" value="instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/Salariat[@id=instance('tmp')/marca]/Sapt[index('repeatSapt')]/Zile/Ziua[index('repeatZis')]/@nr"/>
					        	<!--<xforms:message>ziua= <xforms:output ref="instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/Salariat[@id=instance('tmp')/marca]/Sapt[index('repeatSapt')]/Zile/Ziua[index('repeatZis')]/@nr"/></xforms:message>-->
					        	<xforms:setvalue ref="instance('tmp')/contor" value="1"/>					        	
					        </xforms:action>     							
					        <xforms:action ev:event="DOMActivate" while="instance('tmp')/contor &lt; count(instance('ore')/OreZi)">
        						<xforms:setvalue ref="instance('ore')/OreZi[number(instance('tmp')/contor)]" value="instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/Salariat[@id=instance('tmp')/marca]/Sapt/Zile/Ziua[@nr = instance('ore')/Ziua]/OreZi[@tip = instance('ore')/OreZi[number(instance('tmp')/contor)]/@tip]"/>				        		
								<xforms:setvalue ref="instance('ore')/OreZi[number(instance('tmp')/contor)]/@oreIn" value="instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/Salariat[@id=instance('tmp')/marca]/Sapt/Zile/Ziua[@nr = instance('ore')/Ziua]/OreZi[@tip = instance('ore')/OreZi[number(instance('tmp')/contor)]/@tip]"/>
				       			<xforms:setvalue ref="instance('ore')/OreZi[number(instance('tmp')/contor)]/@totalIn" value="instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/Salariat[@id=instance('tmp')/marca]/TotalPontaj/Ore[@tip = instance('ore')/OreZi[number(instance('tmp')/contor)]/@tip]"/>				      					        	
					        	<!--<xforms:setvalue ref="instance('ore')/OreZi[number(instance('tmp')/contor)]/@totalSf" value=".[repeatZis]/OreZi[@tip = instance('ore')/OreZi[number(instance('tmp')/contor)]/@tip]"/>				      						        	
					        	<xforms:show dialog="alege"/> -->
					        	<xforms:setvalue ref="instance('tmp')/contor" value=". + 1"/>
					        </xforms:action>      								
					        <xforms:action ev:event="DOMActivate">					        						        	
					        	<xforms:show dialog="alege"/>
					        </xforms:action>                
							<xforms:hint>Modifică</xforms:hint>
				        </xforms:trigger>	
				        </td>
				        <td>			  
							<table>
								<xforms:repeat nodeset="OreZi" id="repeatOre">
									<tr>
										<td>									
											<xforms:output ref="@tip" /><xforms:label>: </xforms:label>
											<b><xforms:output class="df2" ref="." /></b>
										</td>								
									</tr>					
					    		</xforms:repeat>
				    		</table>		
					    </td>			        		
					</tr>
				</table>						
			</xforms:repeat>
				</tr>
			</table>	       				
				</xforms:repeat>
				
			</td>							   					
			<!--</table></td></tr>-->

			</tr>			
        </table>
        
        
        <table class="tab" border="0" cellspacing="5" cellpadding="0" width="100%"> 

        <tr><td>
        <table>
        	<!--<tr>
				<td>									
					<xforms:trigger >										
						<xforms:label> Actualizare calcul ore </xforms:label> 	
						<xforms:action ev:event="DOMActivate"> 				        							
							<xforms:delete nodeset="TotalPontaj/Ore"/> 
							<xforms:setvalue ref="TotalPontaj/OreL1-15" value="sum(../../Sapt/Zile/Ziua[@nr &lt; '16']/OreZi[@tip='Lucru'])"/>
							<xforms:setvalue ref="instance('tmp')/contor" value="1"/>	
						</xforms:action>
						<xforms:action ev:event="DOMActivate" while="instance('tmp')/contor &lt; count(instance('ore')/OreZi) + 1"> 
							<xforms:setvalue ref="instance('tmp')/Ore/@tip" value="instance('ore')/OreZi[number(instance('tmp')/contor)]/@tip"/>
							<xforms:setvalue ref="instance('tmp')/Ore" value="sum(instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/Salariat[@id=instance('tmp')/marca]/Sapt/Zile/Ziua/OreZi[@tip = instance('ore')/OreZi[number(instance('tmp')/contor)]/@tip])"/>							
							
							<xforms:action ev:event="DOMActivate" if="instance('tmp')/Ore &gt; 0 ">
								<xforms:insert origin="instance('tmp')/Ore" context="TotalPontaj" nodeset="/Ore"/>		        	
							</xforms:action>									
							<xforms:setvalue ref="instance('tmp')/contor" value=". + 1"/> 	
						</xforms:action> 						                
						<xforms:hint>  </xforms:hint>
					</xforms:trigger>	
				</td>     	
    		</tr>  -->      
        	<tr>	
        		<td> Total ore lucrate 1-15 : </td>
        		<td class="nzo"> <xforms:output  value="TotalPontaj/OreL1-15" class="valdf2"/></td>
        	</tr>
        	<tr>	
        		<td> Totaluri ore : { </td>        		
        		<td class="nzoO">
					<xforms:repeat nodeset="TotalPontaj/Ore" id="repeatOreAlte">						
						<xforms:output value="@tip" /><xforms:label> - </xforms:label>
						<xforms:output value="." />
		    		</xforms:repeat>  

        		</td>
        	</tr> 
    	</table>
    	</td>
		<td>
			<table>
				<tr> 
					<td> Coeficienți </td>
					<td> Indice </td>
					<td> Valoare </td>										
				</tr> 
		        <tr>
		            <td class="Ttd4">Concediu odihna </td>
		            <td class="inp1"><xforms:input type="text" name="text" ref="CoefCO" class="valdf1"/></td>
		            <td class="inpVal"><xforms:output ref="VenitSalarialCO"/></td>
		            <!--<td class="inpVal">
		            	<xforms:group nodeset="instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/Salariat[@Marca=instance('sal')/Personal/Salariat[index('repeatRow')]/@Marca]">
		            		<xforms:output value="CoefCO * sum(Sapt/Zile/Ziua/OreZi[@tip='COdihna']) * TarifSalOraLC"/>
		            	</xforms:group>
		            </td>-->		            
		        </tr>
		        <tr>
		            <td class="Ttd4">Concediu medical </td>
		            <td class="inp1"><xforms:input type="text" name="text" ref="CoefCM" class="valdf1"/></td>
		            <td class="inpVal"><xforms:output value="CoefCM * TotalPontaj/Ore[@tip='CMedical'] * TarifSalOraLC"/></td>		            
		        </tr>	  
		        <tr>
		            <td class="Ttd4">Concediu maternitate </td>
		            <td class="inp1"><xforms:input type="text" name="text" ref="CoefCMat" class="valdf1"/></td>
		            <td class="inpVal"><xforms:output value="CoefCO * TotalPontaj/Ore[@tip='CMatern'] * TarifSalOraLC"/></td>		            
		        </tr>	                      			           
		    </table>
        </td>
		<td>
			<table>
				<tr> 
					<td class="Ttd4"> Salariu </td>
					<td align="right"><xforms:output value="instance('sal')/Personal/Salariat[@id=instance('tmp')/marca]/Contract/Salariu"/></td>
				</tr> 
				<tr> 
		            <td class="Ttd4">Sporuri orare </td>
		            <td class="inpVal"><xforms:input type="text" name="text" ref="Spor" class="valdf1"/></td>
		        </tr>	
		        <tr>
		            <td class="Ttd4">Spor vechime: </td>
		            <td class="inpVal"><xforms:input type="text" name="text" ref="Spor" class="valdf1"/></td>
		        </tr>
		        <tr>
		            <td class="Ttd4">Rețineri: </td>
		            <td class="inpVal"><xforms:input type="text" name="text" ref="Retineri" class="valdf1"/></td>
		        </tr>	  	                      			           
		    </table>
        </td>        
        </tr>	       	
        </table>
                
            <!--<table class="tab" border="0" cellspacing="5" cellpadding="0" width="100%">
       
                <tr>
                  
                    <td rowspan="2" class="Ttd4"><b>Introduceţi avans : 
						<xforms:input type="text" name="text" ref="Avans" class="inpVal"/> lei</b>
					
                    </td>                      
              		<td class="Ttd4">-</td>
                    <td class="Ttd4">Venitul brut lunar = <b><xforms:output value="Venit_Brut" class="valdf3"/> lei</b>
					</td>

					<td rowspan="2" class="Ttd4">Alege deducerea potrivita : 
						<xforms:select1 ref="Deduceri">
							<xforms:itemset nodeset="instance('dg')/Deduceri/DeduceriPL[@id=instance('tmp')/NrPI]/Deducere">
								<xforms:label ref="@expl"/>
								<xforms:value ref="."/>
							</xforms:itemset>	
						</xforms:select1>                      
					</td> 
				</tr>
				<tr>
				<td class="Ttd4">-</td>
				<td class="Ttd4">Copii în întreţinere = <b>
					<xforms:output value="instance('sal')/Personal/Salariat[@id=instance('tmp')/marca]/@Copii_intretinere" class="valdf3"/></b>
				</td>

				</tr>
            </table> --> 
            
			<table align="right" style="padding: .5em 1.5em .5em .5em">
				<tr> 
					<td>
                        <xforms:trigger>
                            <xforms:label><b> Actualizare calcul venituri </b></xforms:label>
                            <xforms:action ev:event="DOMActivate">
                            	<!--<xforms:setvalue ref="VenitSalarialCO" calculate="round(../Spor + ../VenitSalarialCO + (../TotalPontaj/Ore[@tip = 'Lucru'] * ../TarifSalOraLC))"/>-->
                            	<xforms:setvalue ref="TarifSalOraLC" value="if(instance('sal')/Personal/Salariat[@id = instance('tmp')/marca]/Contract/Salariu[@fix = 'da'], instance('sal')/Personal/Salariat[@id = instance('tmp')/marca]/Contract/Salariu div (instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/@NrZlucruL *  instance('sal')/Personal/Salariat[@id = instance('tmp')/marca]/Contract/TimpMuncaNorma), instance('sal')/Personal/Salariat[@id = instance('tmp')/marca]/Contract/TarifSalOra)"/>
                            	<xforms:setvalue ref="VenitSalarialCO" value="../CoefCO * ../TotalPontaj/Ore[@tip='COdihna'] * ../TarifSalOraLC"/>
                            	<xforms:setvalue ref="Venit_Brut" value="round(../Spor + ../VenitSalarialCO + (../TotalPontaj/Ore[@tip = 'Lucru'] * ../TarifSalOraLC))"/>
                            	<xforms:setvalue ref="instance('tmp')/Venit_Brut" value="instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/Salariat[@id=instance('tmp')/marca]/Venit_Brut"/>
                            	<xforms:setvalue ref="Deduceri" value="instance('dg')/Deduceri/DeduceriPL[@id = instance('tmp')/NrPI]/Deducere[@VenitMax &gt; instance('tmp')/Venit_Brut]"/>

                            	<xforms:setvalue ref="VenitSalarial" value="round(../Spor + ../VenitSalarialCO + (../TotalPontaj/Ore[@tip = 'Lucru'] * ../TarifSalOraLC))"/>

								<!--< 2012. OK...CALCUL VENIT SOMAJ   Baza_CVenitSO NEW>-->
								<xforms:setvalue ref="Baza_CVenitSO" value="if(instance('sal')/Personal/Salariat[@id = instance('tmp')/marca]/D112date/AsigSO = '2','0',
								round(../Spor + ../VenitSalarialCO + (../TotalPontaj/Ore[@tip = 'Lucru'] * ../TarifSalOraLC)))"/>


								<!--< 2012..OK..CALCUL VENIT CASS   Baza_CVenitCI NEW>-->
								<xforms:setvalue ref="Baza_CVenitCI" value="if(instance('sal')/Personal/Salariat[@id = instance('tmp')/marca]/D112date/AsigCI = '2','0',
								round(../Spor + ../VenitSalarialCO + (../TotalPontaj/Ore[@tip = 'Lucru'] * ../TarifSalOraLC)))"/>

								<!--< 2012..OK..CAS, SOMAJ(D112date/AsigSO = '2','0'),CASS(D112date/AsigSO = '2','0') INDIVIDUAL PE SALARIATII 2012 NEW>-->
								<xforms:setvalue ref="CAS" value="round(../Venit_Brut * (instance('sal')/NCsal/NC[@id='CoAtCAS']/Procent) div 100)"/>
																
								<xforms:setvalue ref="Somaj" value="if(instance('sal')/Personal/Salariat[@id = instance('tmp')/marca]/D112date/AsigSO = '2','0',
								round(../Venit_Brut * (instance('sal')/NCsal/NC[@id='CoAtFS']/Procent) div 100))"/>

								<xforms:setvalue ref="CASS" value="if(instance('sal')/Personal/Salariat[@id = instance('tmp')/marca]/D112date//AsigCI = '2','0',
								round(../Venit_Brut * (instance('sal')/NCsal/NC[@id='CoAtCASS']/Procent) div 100))"/>

                            	<xforms:setvalue ref="Venit_Baza_Calcul" value="if(../Venit_Brut - (../CAS + ../Somaj + ../CASS + ../Deduceri) * (100 div 100) &lt; 0,'0', ../Venit_Brut - (../CAS + ../Somaj + ../CASS + ../Deduceri) * (100 div 100))"/>
								<xforms:setvalue ref="Impozit_Retinut" value="if(../Venit_Baza_Calcul &lt; 0,'0',round(../Venit_Baza_Calcul * 0.16 * 100  div 100))"/>
								<xforms:setvalue ref="Total_de_Plata" value="round(../Venit_Brut - (../CAS + ../Somaj + ../CASS + ../Retineri + ../Impozit_Retinut))"/>
                            </xforms:action>
                        </xforms:trigger>					
					</td>
					<td> 
						<table>	
							<tr>
								<td class="Ttd4">Venit brut </td>
								<td align="right"><b><xforms:output type="text" name="text" ref="Venit_Brut" class="valdf1"/></b></td>
							</tr>
							<tr>
								<td class="Ttd4">Deduceri ( <xforms:output  ref="instance('tmp')/NrPI" class="valdf1"/> pers ) </td>
								<td align="right"><b><xforms:output type="text" name="text" ref="Deduceri" class="valdf1"/></b></td>
							</tr>
							<tr>
								<td class="Ttd4">Venit net </td>
								<td align="right"><b><xforms:output  ref="Total_de_Plata" class="outputp"/></b></td>
							</tr>
							<tr>
								<td class="Ttd4">Avans </td>
								<td class="inpVal"><b><xforms:input type="text" name="text" ref="Avans" class="valdf1"/></b></td>
							</tr>		        		        			        		        		                       			       		        			<tr>
								<td class="Ttd4">Rest de plată </td>
								<td align="right"><b><xforms:output value="round(Total_de_Plata - Avans)" class="outputp"/></b></td>
							</tr>			           
						</table> 					
					</td>
				</tr> 				           
		    </table>  
		                          
            <table class="tab" border="0" cellspacing="3" cellpadding="2" width="100%">
                <tr id="Fond">
                <td style="padding-left:2em;">
                    <xforms:trigger appearance="minimal" id="corectie">
                            <xforms:label class="small button greenn">&#164; Salvează &#164;</xforms:label>
<xforms:hint>Modifică date</xforms:hint>
                            <!-- ?? <xforms:insert nodeset="/SAL/Personal/Salariat" at="index('repeatRow')" replace="true"/> ?? -->
                            <xforms:action ev:event="DOMActivate">
                            	<!--<xforms:setvalue ref="VenitSalarialCO" calculate="round(../Spor + ../VenitSalarialCO + (../TotalPontaj/Ore[@tip = 'Lucru'] * ../TarifSalOraLC))"/>-->
                            	<xforms:setvalue ref="TarifSalOraLC" value="if(instance('sal')/Personal/Salariat[@id = instance('tmp')/marca]/Contract/Salariu[@fix = 'da'], instance('sal')/Personal/Salariat[@id = instance('tmp')/marca]/Contract/Salariu div (instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/@NrZlucruL *  instance('sal')/Personal/Salariat[@id = instance('tmp')/marca]/Contract/TimpMuncaNorma), instance('sal')/Personal/Salariat[@id = instance('tmp')/marca]/Contract/TarifSalOra)"/>
                            	<xforms:setvalue ref="VenitSalarialCO" value="../CoefCO * ../TotalPontaj/Ore[@tip='COdihna'] * ../TarifSalOraLC"/>
                            	<xforms:setvalue ref="Venit_Brut" value="round(../Spor + ../VenitSalarialCO + (../TotalPontaj/Ore[@tip = 'Lucru'] * ../TarifSalOraLC))"/>
                            	<xforms:setvalue ref="VenitSalarial" value="round(../Spor + ../VenitSalarialCO + (../TotalPontaj/Ore[@tip = 'Lucru'] * ../TarifSalOraLC))"/>

								<!--< 2012. OK...CALCUL VENIT SOMAJ   Baza_CVenitSO NEW>-->
								<xforms:setvalue ref="Baza_CVenitSO" value="if(instance('sal')/Personal/Salariat[@id = instance('tmp')/marca]/D112date/AsigSO = '2','0',
								round(../Spor + ../VenitSalarialCO + (../TotalPontaj/Ore[@tip = 'Lucru'] * ../TarifSalOraLC)))"/>


								<!--< 2012..OK..CALCUL VENIT CASS   Baza_CVenitCI NEW>-->
								<xforms:setvalue ref="Baza_CVenitCI" value="if(instance('sal')/Personal/Salariat[@id = instance('tmp')/marca]/D112date/AsigCI = '2','0',
								round(../Spor + ../VenitSalarialCO + (../TotalPontaj/Ore[@tip = 'Lucru'] * ../TarifSalOraLC)))"/>

								<!--< 2012..OK..CAS, SOMAJ(D112date/AsigSO = '2','0'),CASS(D112date/AsigSO = '2','0') INDIVIDUAL PE SALARIATII 2012 NEW>-->
								<xforms:setvalue ref="CAS" value="round(../Venit_Brut * (instance('sal')/NCsal/NC[@id='CoAtCAS']/Procent) div 100)"/>
																
								<xforms:setvalue ref="Somaj" value="if(instance('sal')/Personal/Salariat[@id = instance('tmp')/marca]/D112date/AsigSO = '2','0',
								round(../Venit_Brut * (instance('sal')/NCsal/NC[@id='CoAtFS']/Procent) div 100))"/>

								<xforms:setvalue ref="CASS" value="if(instance('sal')/Personal/Salariat[@id = instance('tmp')/marca]/D112date//AsigCI = '2','0',
								round(../Venit_Brut * (instance('sal')/NCsal/NC[@id='CoAtCASS']/Procent) div 100))"/>

                            	<xforms:setvalue ref="Venit_Baza_Calcul" value="if(../Venit_Brut - (../CAS + ../Somaj + ../CASS + ../Deduceri) * (100 div 100) &lt; 0,'0', ../Venit_Brut - (../CAS + ../Somaj + ../CASS + ../Deduceri) * (100 div 100))"/>
								<xforms:setvalue ref="Impozit_Retinut" value="if(../Venit_Baza_Calcul &lt; 0,'0',round(../Venit_Baza_Calcul * 0.16 * 100  div 100))"/>
								<xforms:setvalue ref="Total_de_Plata" value="round(../Venit_Brut - (../CAS + ../Somaj + ../CASS + ../Retineri + ../Impozit_Retinut))"/>
									
								<xforms:load resource="javascript:saveDataLocal('sal')"/>
                            	<xforms:hide dialog="editPontaj"/>
                            </xforms:action>
                    </xforms:trigger>

<!-- Dialog COCM  in -->

                        <xforms:trigger appearance="minimal">
                            <xforms:label class="small button greenn">&#164; CalcularorCM &#164;</xforms:label>	
								<xforms:hint>Date concediu medical</xforms:hint>						
                            <xforms:action ev:event="DOMActivate">
                            	<xforms:setvalue ref="instance('tmp')/tipform" value="'edit'"/>
								<xforms:show dialog="comed"/>	
                            </xforms:action>
                        </xforms:trigger>

                        <xforms:trigger appearance="minimal">
                            <xforms:label class="small button greenn">&#164; CalcularorCO &#164;</xforms:label>	
								<xforms:hint>Date concediu odihna</xforms:hint>						
                            <xforms:action ev:event="DOMActivate">
                            	<xforms:setvalue ref="instance('tmp')/tipform" value="'edit'"/>
								<xforms:show dialog="codihna"/>	
                            </xforms:action>
                        </xforms:trigger>

<!-- Dialog COCM  end -->

                    <xforms:trigger appearance="minimal">
                            <xforms:label class="small button blue">&#164; Renunță &#164;</xforms:label>
								<xforms:hint>Renunță la modificate</xforms:hint>	
                            <xforms:action ev:event="DOMActivate">
                            	<xforms:hide dialog="editPontaj"/>
                            </xforms:action>
                    </xforms:trigger> 
                </td>                   
                </tr>
            </table>
            </td></tr>
        </table>

        <!--<table>
        	<tr>
        		<td>
        			Ziua din inst. ore <xforms:output ref="instance('ore')/Ziua" />
					<xforms:repeat nodeset="instance('ore')/OreZi" id="repeatOreDplus">
															
						Ore <xforms:output ref="@tip" /> -     
						<xforms:input ref="." />
					</xforms:repeat>
				</td>
        		<td>
        			Ziua din date lunare <xforms:output ref="instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/Salariat[@id=instance('tmp')/marca]/Sapt/Zile/Ziua[@nr = instance('ore')/Ziua]/@nr" />
					<xforms:repeat nodeset="instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/Salariat[@id=instance('tmp')/marca]/Sapt/Zile/Ziua[@nr = instance('ore')/Ziua]/OreZi" id="repeatOreDL">
															
						Ore <xforms:output ref="@tip" /> -     
						<xforms:input ref="." />
					</xforms:repeat>
				</td>				
			</tr>  
		</table>
		
		venitbrut= <xforms:output ref="Venit_Brut"/>   -->			      
		</div>

		</xforms:group>		
    	</xforms:dialog> 

<!--"editPontaj" -->
 
        
		<xforms:dialog id="alege"> 
			 		
			<div>					
				<div>
					<xforms:output ref="instance('ore')/Ziua">
						<xforms:label>Ziua</xforms:label>
					</xforms:output>
					<xforms:repeat nodeset="instance('ore')/OreZi" id="repeatOreD">										
						Ore <xforms:output ref="@tip" />    
						<xforms:input ref="." />
					</xforms:repeat>   	
		        </div>		        	   
				<hr/>       
            </div>
            <xforms:group nodeset="Salariat" ref="instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/Salariat[@id=instance('tmp')/marca]">		
			<xforms:trigger appearance="minimal">
				<xforms:label class="medium button teal"> OK </xforms:label>				
		        <xforms:action ev:event="DOMActivate">
		        	<xforms:setvalue ref="instance('tmp')/contor" value="1"/>		        	
		        </xforms:action>
		        
		        <xforms:action ev:event="DOMActivate" while="instance('tmp')/contor &lt; count(instance('ore')/OreZi) + 1">
		        	<!-- Setări în instanța 'ore' -->
		        	<xforms:action ev:event="DOMActivate" if="instance('ore')/OreZi[number(instance('tmp')/contor)] &lt; 1">
		        		<xforms:delete nodeset="Sapt/Zile/Ziua[@nr = instance('ore')/Ziua]/OreZi[@tip = instance('ore')/OreZi[number(instance('tmp')/contor)]/@tip]"/>
		        	</xforms:action>
		        	<xforms:action ev:event="DOMActivate" if="instance('ore')/OreZi[number(instance('tmp')/contor)] &gt; 0">
		        		<xforms:action ev:event="DOMActivate" if="Sapt/Zile/Ziua[@nr = instance('ore')/Ziua]/OreZi[@tip = instance('ore')/OreZi[number(instance('tmp')/contor)]/@tip] != 0">
		        			<xforms:setvalue ref="Sapt/Zile/Ziua[@nr = instance('ore')/Ziua]/OreZi[@tip = instance('ore')/OreZi[number(instance('tmp')/contor)]/@tip]" value="instance('ore')/OreZi[number(instance('tmp')/contor)]"/>
		        		</xforms:action>			        	
				    	<xforms:action ev:event="DOMActivate" if="not(Sapt/Zile/Ziua[@nr = instance('ore')/Ziua]/OreZi[@tip = instance('ore')/OreZi[number(instance('tmp')/contor)]/@tip])">
							<xforms:insert origin="instance('ore')/OreZi[number(instance('tmp')/contor)]" context="Sapt[index('repeatSapt')]/Zile/Ziua[index('repeatZis')]" nodeset="/OreZi"/>
				    	</xforms:action>
				    </xforms:action>		     	
	        		<!-- Setări în totaluri
			    	<xforms:action ev:event="DOMActivate" if="not(TotalPontaj/Ore[@tip = instance('ore')/OreZi[number(instance('tmp')/contor)]/@tip])">
			    		<xforms:setvalue ref="instance('tmp')/Ore/@tip" value="instance('ore')/OreZi[number(instance('tmp')/contor)]/@tip"/>
			    		<xforms:setvalue ref="instance('tmp')/Ore" value="sum(instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/Salariat[@id=instance('tmp')/marca]/Sapt/Zile/Ziua/OreZi[@tip = instance('ore')/OreZi[number(instance('tmp')/contor)]/@tip])"/>
						<xforms:insert origin="instance('tmp')/Ore" context="TotalPontaj" nodeset="Ore"/>
			    	</xforms:action>				    	
			    	<xforms:action ev:event="DOMActivate" if="not(Sapt/Zile/Ziua/OreZi[@tip = instance('ore')/OreZi[number(instance('tmp')/contor)]/@tip])">
						<xforms:delete nodeset="TotalPontaj/Ore[@tip = instance('ore')/OreZi[number(instance('tmp')/contor)]/@tip]"/>
			    	</xforms:action>
			    	<xforms:action ev:event="DOMActivate" if="Sapt/Zile/Ziua/OreZi[@tip = instance('ore')/OreZi[number(instance('tmp')/contor)]/@tip]">			        	
		        		<xforms:setvalue ref="TotalPontaj/Ore[@tip = instance('ore')/OreZi[number(instance('tmp')/contor)]/@tip]" value="sum(instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/Salariat[@id=instance('tmp')/marca]/Sapt/Zile/Ziua/OreZi[@tip = instance('ore')/OreZi[number(instance('tmp')/contor)]/@tip])"/>
			    	</xforms:action> -->			    			        	
					<xforms:setvalue ref="instance('tmp')/contor" value=". + 1"/>
		        </xforms:action>
		        
		        <!-- plus totaluri preluate dela actualizare ore  -->
				<xforms:action ev:event="DOMActivate"> 				        							
					<xforms:delete nodeset="TotalPontaj/Ore"/><!----> 
					<xforms:setvalue ref="TotalPontaj/OreL1-15" value="sum(../../Sapt/Zile/Ziua[@nr &lt; '16']/OreZi[@tip='Lucru'])"/>
					<xforms:setvalue ref="instance('tmp')/contor" value="1"/>	
				</xforms:action>
				<xforms:action ev:event="DOMActivate" while="instance('tmp')/contor &lt; count(instance('ore')/OreZi) + 1"> 
					<xforms:setvalue ref="instance('tmp')/Ore/@tip" value="instance('ore')/OreZi[number(instance('tmp')/contor)]/@tip"/>
					<xforms:setvalue ref="instance('tmp')/Ore" value="sum(instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/Salariat[@id=instance('tmp')/marca]/Sapt/Zile/Ziua/OreZi[@tip = instance('ore')/OreZi[number(instance('tmp')/contor)]/@tip])"/>							
					
					<xforms:action ev:event="DOMActivate" if="instance('tmp')/Ore &gt; 0 ">
						<xforms:insert origin="instance('tmp')/Ore" context="TotalPontaj" nodeset="/Ore"/>		        	
					</xforms:action>									
					<xforms:setvalue ref="instance('tmp')/contor" value=". + 1"/> 	
				</xforms:action> 
								        
		        <xforms:action ev:event="DOMActivate">
		        	<xforms:hide dialog="alege"/>
		        </xforms:action> 			         		         
            </xforms:trigger>
            </xforms:group>   		
		</xforms:dialog> 

		
		<xforms:dialog id="lipsaLuna"> 
			<div>	
				Nu sunt date pentru luna aleasă ! Alegeți altă lună sau inițializați-o pe cea dorită.
				<br/>
				<xforms:trigger appearance="minimal">
					<xforms:label class="medium button teal"> Închide </xforms:label>				
				    <xforms:action ev:event="DOMActivate">
				    	<xforms:hide dialog="lipsaLuna"/>
				    </xforms:action> 
		        </xforms:trigger>   		            	
            </div>		        			
		</xforms:dialog>  








<!-- Dialog COCM  in -->

	<xforms:dialog id="comed">
			<xforms:group nodeset="Salariat" ref="instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/Salariat[@id=instance('tmp')/marca]"> 	
			<div align="center" style="width:95% ; padding:0px 0px 0px 10px;">
	<table border="0" align="center">
		<tr>
			<h4 align="center">CALCULATOR CONCEDIU MEDICAL</h4>  

		<td>An : </td>
		<td><b><xforms:output value="substring(instance('sal')/LunaLucru,5,2)" class="val3"/></b></td>
		<td> - Luna : </td>
		<td><b><xforms:output value="substring(instance('sal')/LunaLucru,1,4)" class="val3"/></b></td>
		</tr>
	</table>

<div align="left" style="width:100% ; padding:0px 0px 0px 40px;">

	<table>
		<tr>
			<td>  
				<label>Societatea : </label><b>
				<xforms:output ref="instance('sal')/Date_firma/Prefix" class="val3"/>
				<xforms:output ref="instance('sal')/Date_firma/Firma" class="val2"/>
				<xforms:output ref="instance('sal')/Date_firma/Sufix" class="val3"/>
				</b></td>   
			<td>
				<label>CUI: RO </label><b>
				<xforms:output ref="instance('sal')/Date_firma/CISTVA" class="val2"/></b> 
		</td>
    </tr>
  </table>

</div>

		<table align="center" border="0" cellspacing="3" cellpadding="0" width="95%"> 

					<tr>
						<td class="t7r1c4">CNP - <xforms:label/></td>
						<td class="t7r1c3"><xforms:output class="T1val0" value="instance('sal')/Personal/Salariat[@id=instance('tmp')/marca]/@CNP"/></td>
						<td class="t7r1c4">SERIE CERTIFICAT - <xforms:label/></td>
						<td class="t7r1c3"><xforms:input class="inpVal" value="instance('como')/CO/Certificat/SerieCM"/></td>
					</tr>
					<tr>
						<td class="t7r1c4">NUME - <xforms:label/></td> 
						<td class="t7r1c3"><xforms:output class="T1val0" value="instance('sal')/Personal/Salariat[@id=instance('tmp')/marca]/@Nume"/></td>
						<td class="t7r1c4">NR.CERTIFICAT - <xforms:label class="T1val0"/></td>
						<td class="t7r1c3"><xforms:input class="inp4" value="instance('como')/CO/Certificat/NrCM"/></td>
					</tr>	
					<tr>
						<td class="t7r1c4">PRENUME - <xforms:label/></td>
						<td class="t7r1c3"><xforms:output class="T1val0" value="instance('sal')/Personal/Salariat[@id=instance('tmp')/marca]/@Prenume"/></td>
						<td class="t7r1c4">DATA ACORDĂRII - <xforms:label/></td>
						<td class="t7r1c3"><xforms:input class="inpd" ref="/SAL/Date_operare/Data"/></td>
					</tr>
					<tr>
						<td class="t7r1c4">SALARIU BAZA - <xforms:label/></td>
						<td class="t7r1c3"><xforms:output class="inp2" ref="instance('sal')/Personal/Salariat[@id=instance('tmp')/marca]/Contract/Salariu"/> lei</td>
						<td class="t7r1c4">ZILE CALENDARISTICE - <xforms:label/></td>
						<td class="t7r1c3"><xforms:input class="inpVal" value="instance('como')/CO/Certificat/ZileCM"/></td>
					</tr>
					<tr>
						<!--<td class="t7r1c4">DATA ACORDARII - DE LA<xforms:output/></td>-->
						<td colspan='2' class="t7r1c4">CERTIFICAT MEDICAL - PERIOADĂ ACORDARE - Data : <xforms:label/></td>
						<td colspan='0' class="t7r1c3">de la : <xforms:label/>
							<xforms:input class="inpd" ref="/SAL/Date_operare/Data"/></td>
						<!--<td colspan='0' class="t7r1c4"> PANA LA - DATA - <xforms:label/></td>-->
						<td colspan='0' class="t7r1c3">până la : <xforms:label/>
							<xforms:input class="inpd" ref="/SAL/Date_operare/Data"/></td>
					</tr>
					<tr>
						<td class="t7r1c4">MEDIC PRESCRIPTOR - <xforms:label/></td>
						<td class="t7r1c3"><xforms:input class="inp4" value="instance('como')/CO/Certificat/Medic"/></td>
						<td class="t7r1c4">UNITATEA SANITARĂ - <xforms:label class="T1val1"/></td>
						<td class="t7r1c3"><xforms:input class="inp4" value="instance('como')/CO/Certificat/Umedicala"/></td>
					</tr>
<hr align="center" color="#D7D5D8" width="95%"/>

					<tr>
			<td colspan='0' class="t7r1c4">COD INDEMNIZAŢIE - <xforms:label class="T1val1"/></td>

				<td colspan='0' class="Tco10">
				<xforms:select1 value="instance('como')/CO/ConcediuM/ProcCM">  
							<xforms:item>
								<xforms:label>01 - Boală obişnuită 75 % </xforms:label>
								<xforms:value>75</xforms:value> 
							</xforms:item>
							<xforms:item>
								<xforms:label>02 - Accident in timpul deplasari la locul de munca 100 % </xforms:label>
								<xforms:value>100</xforms:value> 
							</xforms:item>
							<xforms:item>
								<xforms:label>02 - Accident in timpul deplasari la locul de munca 80 % </xforms:label>
								<xforms:value>80</xforms:value> 
							</xforms:item>
							<xforms:item>
								<xforms:label>03 - Accident de muncă 100 % </xforms:label>
								<xforms:value>100</xforms:value> 
							</xforms:item>
							<xforms:item>
								<xforms:label>03 - Accident de muncă 80 % </xforms:label>
								<xforms:value>80</xforms:value>
							</xforms:item>
							<xforms:item>
								<xforms:label>04 - Boală profesională 100 % </xforms:label>
								<xforms:value>100</xforms:value> 
							</xforms:item>
							<xforms:item>
								<xforms:label>04 - Boală profesională 80 % </xforms:label>
								<xforms:value>80</xforms:value>
							</xforms:item>

							<xforms:item>
								<xforms:label>05 - Boala infectioasa din grupa A 100 % </xforms:label>
								<xforms:value>100</xforms:value>
							</xforms:item>
							<xforms:item>
								<xforms:label>06 - Urgenta medico-chirurgicală 100 % </xforms:label>
								<xforms:value>100</xforms:value> 
							</xforms:item>
							<xforms:item>
								<xforms:label>07 - Carantină 70 % </xforms:label>
								<xforms:value>75</xforms:value>
							</xforms:item>
							<xforms:item>
								<xforms:label>08 - Sarcină şi lehuzie 85 %</xforms:label>
								<xforms:value>85</xforms:value>
							</xforms:item>
							<xforms:item>
								<xforms:label>09 -Ingrigire copil bolnav cu vârsta pana la 7 ani 85 %</xforms:label>
								<xforms:value>85</xforms:value>
							</xforms:item> 
							<xforms:item>
								<xforms:label>10 -Reducerea cu 1/4 a duratei normale de lucru 25 %</xforms:label>
								<xforms:value>25</xforms:value>
							</xforms:item> 
							<xforms:item>
								<xforms:label>11 -Trecerea temoprară în altă muncă 25 %</xforms:label>
								<xforms:value>25</xforms:value>
							</xforms:item> 			
							<xforms:item>
								<xforms:label>12 -Tuberculoză 100 %</xforms:label>
								<xforms:value>100</xforms:value>
							</xforms:item> 
							<xforms:item>
								<xforms:label>13 -Boală cardio vasculară 75 %</xforms:label>
								<xforms:value>75</xforms:value>
							</xforms:item> 
							<xforms:item>
								<xforms:label>14 -Cancer HIV SIDA 100 %</xforms:label>
								<xforms:value>100</xforms:value>
							</xforms:item> 
							<xforms:item>
								<xforms:label>15 -Risc maternal 75 %</xforms:label>
								<xforms:value>75</xforms:value>
							</xforms:item> 			
							<xforms:item>
								<xforms:label>99 - Creşterea copilului cu vărsta pana la 2 ani 0 % </xforms:label>
								<xforms:value>0</xforms:value>
							</xforms:item>
					</xforms:select1>
				</td>

<td colspan="1" rowspan='4' class="t7r1c4">COD DIAGNOSTIC - <xforms:label class="T1val1"/></td>
<td class="Tco44"><xforms:input class="inpVal" value="instance('como')/CO/ConcediuM/Codiag"/>
							<b>
							<xforms:select ref="instance('como')/CO/ConcediuM/CodiagTip" selection="closed" appearance="full">
								<xforms:item>
									<xforms:label>Acut</xforms:label>
									<xforms:value>Acut</xforms:value>
								</xforms:item>
								<xforms:item>
									<xforms:label>Subacut</xforms:label>
									<xforms:value>Subacut</xforms:value>
								</xforms:item>
								<xforms:item>
									<xforms:label>Cronic</xforms:label>
									<xforms:value>Cronic</xforms:value>
								</xforms:item>
							</xforms:select>
						</b></td>
					</tr>		
		</table>

<!--<hr align="center" color="#D7D5D8" width="95%"/>-->
	
<!--<table align="center" border="0" cellspacing="3" cellpadding="0" width="95%"> 
							<tr rowspan='3'>
<td colspan="1" rowspan='4' class="t7r1c4">COD DIAGNOSTIC - <xforms:label class="T1val1"/></td>
<td></td>
<td  class="t7r1c4X">Acut - <xforms:label class="T1val1"/></td>
<td>X</td>
							<td rowspan="3" class="tit2"><b>
							<xforms:select ref="instance('como')/CO/ConcediuM/CodiagTip" selection="closed" appearance="full">
								<xforms:item>
									<xforms:label>Acut</xforms:label>
									<xforms:value>Acut</xforms:value>
								</xforms:item>
								<xforms:item>
									<xforms:label>Subacut</xforms:label>
									<xforms:value>Subacut</xforms:value>
								</xforms:item>
								<xforms:item>
									<xforms:label>Cronic</xforms:label>
									<xforms:value>Cronic</xforms:value>
								</xforms:item>
							</xforms:select>
						</b></td></tr>
<tr>
<td class="Tco4"><xforms:input class="inpVal" value="instance('como')/CO/ConcediuM/Codiag"/></td>
<td class="t7r1c4X">Subacut - <xforms:label class="T1val1"/></td>

<td>_</td>
</tr>
<tr>
<td></td>
<td  class="t7r1c4X">Cronic - <xforms:label class="T1val1"/></td>
<td >_</td>
</tr>	
<tr>
<td></td>
<td  class="t7r1c4X">Peste 30Zile - <xforms:label class="T1val1"/></td>
<td>-</td>
</tr>
		</table>-->


<hr align="center" color="#D7D5D8" width="95%"/>

<xforms:group>
	<table align="center" border="0" cellspacing="3" cellpadding="0" width="95%"> 
		<tr>
			<th colspan='2' class="Tco1">Baza / Calcul</th>
			<th class="Tco1">luna-1</th>
			<th class="Tco1">luna-2</th>
			<th class="Tco1">luna-3</th>
			<th class="Tco1">luna-4</th>
			<th class="Tco1">luna-5</th>
			<th class="Tco1">luna-6</th>
			<th colspan='3' class="Tco1">total venit-zile / ultimlel-6luni</th>
		</tr>
		<tr>
			<td colspan='2' class="Tco1" >Venit/Luna<xforms:label class="inpVal"/></td>
			<td class="Tco4"><xforms:input class="inpVal" value="instance('como')/CO/ConcediuM/Luna1CM"/></td>
			<td class="Tco4"><xforms:input class="inpVal" value="instance('como')/CO/ConcediuM/Luna2CM"/></td>
			<td class="Tco4"><xforms:input class="inpVal" value="instance('como')/CO/ConcediuM/Luna3CM"/></td>
			<td class="Tco4"><xforms:input class="inpVal" value="instance('como')/CO/ConcediuM/Luna4CM"/></td>
			<td class="Tco4"><xforms:input class="inpVal" value="instance('como')/CO/ConcediuM/Luna5CM"/></td>
			<td class="Tco4"><xforms:input class="inpVal" value="instance('como')/CO/ConcediuM/Luna6CM"/></td>
			<td colspan='3' class="Tco1"><xforms:output class="Tcoval1" ref="TVU6L"/></td>
		</tr>

		<tr>
			<td colspan='2' class="Tco1">Zile Lucru/Luna<xforms:label class="Tcoval1"/></td>
     <td class="Tco16">
         <xforms:select1 value="instance('como')/CO/ConcediuM/ZileL1CM">  
                <xforms:item>
                    <xforms:label>23 Zile</xforms:label>
                    <xforms:value>23</xforms:value> 
                </xforms:item>

                <xforms:item>
                    <xforms:label>22 Zile</xforms:label>
                    <xforms:value>22</xforms:value>
                </xforms:item>

                <xforms:item>
                    <xforms:label>21 Zile</xforms:label>
                    <xforms:value>21</xforms:value>
                </xforms:item>

                <xforms:item>
                    <xforms:label>20 Zile</xforms:label>
                    <xforms:value>20</xforms:value>
                </xforms:item> 

               <xforms:item>
                    <xforms:label>19 Zile</xforms:label>
                    <xforms:value>19</xforms:value>
                </xforms:item> 
         </xforms:select1>
	</td>
			<!--<td class="Tco4"><xforms:input class="inpVal" value="instance('como')/CO/ConcediuM/ZileL2CM"/></td>-->
     <td class="Tco16">
         <xforms:select1 value="instance('como')/CO/ConcediuM/ZileL2CM">  
                <xforms:item>
                    <xforms:label>23 Zile</xforms:label>
                    <xforms:value>23</xforms:value> 
                </xforms:item>

                <xforms:item>
                    <xforms:label>22 Zile</xforms:label>
                    <xforms:value>22</xforms:value>
                </xforms:item>

                <xforms:item>
                    <xforms:label>21 Zile</xforms:label>
                    <xforms:value>21</xforms:value>
                </xforms:item>

                <xforms:item>
                    <xforms:label>20 Zile</xforms:label>
                    <xforms:value>20</xforms:value>
                </xforms:item> 

               <xforms:item>
                    <xforms:label>19 Zile</xforms:label>
                    <xforms:value>19</xforms:value>
                </xforms:item> 
         </xforms:select1>
	</td>
			<!--<td class="Tco4"><xforms:input class="inpVal" value="instance('como')/CO/ConcediuM/ZileL3CM"/></td>-->
     <td class="Tco16">
         <xforms:select1 value="instance('como')/CO/ConcediuM/ZileL3CM">  
                <xforms:item>
                    <xforms:label>23 Zile</xforms:label>
                    <xforms:value>23</xforms:value> 
                </xforms:item>

                <xforms:item>
                    <xforms:label>22 Zile</xforms:label>
                    <xforms:value>22</xforms:value>
                </xforms:item>

                <xforms:item>
                    <xforms:label>21 Zile</xforms:label>
                    <xforms:value>21</xforms:value>
                </xforms:item>

                <xforms:item>
                    <xforms:label>20 Zile</xforms:label>
                    <xforms:value>20</xforms:value>
                </xforms:item> 

               <xforms:item>
                    <xforms:label>19 Zile</xforms:label>
                    <xforms:value>19</xforms:value>
                </xforms:item> 
         </xforms:select1>
	</td>
			<!--<td class="Tco4"><xforms:input class="inpVal" value="instance('como')/CO/ConcediuM/ZileL3CM"/></td>-->
     <td class="Tco16">
         <xforms:select1 value="instance('como')/CO/ConcediuM/ZileL4CM">  
                <xforms:item>
                    <xforms:label>23 Zile</xforms:label>
                    <xforms:value>23</xforms:value> 
                </xforms:item>

                <xforms:item>
                    <xforms:label>22 Zile</xforms:label>
                    <xforms:value>22</xforms:value>
                </xforms:item>

                <xforms:item>
                    <xforms:label>21 Zile</xforms:label>
                    <xforms:value>21</xforms:value>
                </xforms:item>

                <xforms:item>
                    <xforms:label>20 Zile</xforms:label>
                    <xforms:value>20</xforms:value>
                </xforms:item> 

               <xforms:item>
                    <xforms:label>19 Zile</xforms:label>
                    <xforms:value>19</xforms:value>
                </xforms:item> 
         </xforms:select1>
	</td>
			<!--<td class="Tco4"><xforms:input class="inpVal" value="instance('como')/CO/ConcediuM/ZileL4CM"/></td> -->
     <td class="Tco16">
         <xforms:select1 value="instance('como')/CO/ConcediuM/ZileL5CM">  
                <xforms:item>
                    <xforms:label>23 Zile</xforms:label>
                    <xforms:value>23</xforms:value> 
                </xforms:item>

                <xforms:item>
                    <xforms:label>22 Zile</xforms:label>
                    <xforms:value>22</xforms:value>
                </xforms:item>

                <xforms:item>
                    <xforms:label>21 Zile</xforms:label>
                    <xforms:value>21</xforms:value>
                </xforms:item>

                <xforms:item>
                    <xforms:label>20 Zile</xforms:label>
                    <xforms:value>20</xforms:value>
                </xforms:item> 

               <xforms:item>
                    <xforms:label>19 Zile</xforms:label>
                    <xforms:value>19</xforms:value>
                </xforms:item> 
         </xforms:select1>
	</td>
			<!--<td class="Tco4"><xforms:input class="inpVal" value="instance('como')/CO/ConcediuM/ZileL5CM"/></td>-->
     <td class="Tco16">
         <xforms:select1 value="instance('como')/CO/ConcediuM/ZileL6CM">  
                <xforms:item>
                    <xforms:label>23 Zile</xforms:label>
                    <xforms:value>23</xforms:value> 
                </xforms:item>

                <xforms:item>
                    <xforms:label>22 Zile</xforms:label>
                    <xforms:value>22</xforms:value>
                </xforms:item>

                <xforms:item>
                    <xforms:label>21 Zile</xforms:label>
                    <xforms:value>21</xforms:value>
                </xforms:item>

                <xforms:item>
                    <xforms:label>20 Zile</xforms:label>
                    <xforms:value>20</xforms:value>
                </xforms:item> 

               <xforms:item>
                    <xforms:label>19 Zile</xforms:label>
                    <xforms:value>19</xforms:value>
                </xforms:item> 
         </xforms:select1>
	</td>
			<!--<td class="Tco4"><xforms:input class="inpVal" value="instance('como')/CO/ConcediuM/ZileL6CM"/></td>-->
			<td colspan='3' class="Tco1"><xforms:output class="inpVal" ref="TZU6L"/></td>   
		</tr>
		<tr>
			<td colspan='11' class="Tco9"><i>
	CALCUL IN FUNCTIE DE VENITUL SI ZILELE LUCRATE PE ULTIMELE 6 LUNI INAINTE DE PLECAREA IN CONCEDIU MEDICAL CARE SUNT PRELUATE DIN ULTIMELE 6 STATE DE PLATA
	</i><xforms:label class="Tcoval1"/></td>
		</tr>
	</table>
</xforms:group>

<hr align="center" color="#D7D5D8" width="95%"/>

<table align="center" border="0" cellspacing="3" cellpadding="3" width="95%"> 
	<xforms:group>   
		<tr>
			<th class="Tco8">Total venit pe ultimele 6luni-(1)</th>
			<th class="Tco8">Total zile lucrate pe ultimele 6luni-(2)</th>
			<th class="Tco8">Media zilnica baza de calcul indemnizatie 6luni-(3)<br/>3=1/3 </th>
			<th class="Tco8">Procent baza calcul indemnizatie CM - % - (4)</th> 
			<th class="Tco8">NR ZILE CONCEDIU MEDICAL - (5)</th> 
			<th class="Tco8">INDEM.BRUTA CONCEDIU MED (6)<br/>6=3*5*6</th>
		</tr>     
		<tr>
			<td class="Tco7"><xforms:output class="Tcoval7" value="instance('como')/CO/ConcediuM/TVU6L"/></td>
			<td class="Tco7"><xforms:output class="Tcoval7" value="instance('como')/CO/ConcediuM/TZU6L"/></td>
			<td class="Tco7"><xforms:output class="Tcoval7" value="instance('como')/CO/ConcediuM/MedV6L"/></td>
			<td class="Tco7"><xforms:output class="Tcoval7" value="instance('como')/CO/ConcediuM/ProcCM"/> %</td>
			<td class="Tco7"><xforms:output class="Tcoval7" value="instance('como')/CO/ConcediuM/NrZCM"/></td>
			<td class="Tco7"><xforms:output class="Tcoval7" value="instance('como')/CO/ConcediuM/IndemCMBr"/></td>     
		</tr>
	</xforms:group>
</table>


<hr align="center" color="#D7D5D8" width="95%"/>
 
	<table align="center" border="0" cellspacing="3" cellpadding="3" width="95%">
		<xforms:group>   
			<tr>
				<th class="Tco8">Salarui minim pe economie</th>
				<th class="Tco8">Procent CAS asigurat % </th>
				<th class="Tco8">Valoare CAS asigurat</th>
				<th class="Tco8">Indemnizatie CM brut</th> 
				<th class="Tco8">INDEMNIZATIE PLATA CON.MEDICAL</th>
			</tr>   
			<tr>
				<td class="Tco7"><xforms:input class="inpVal" value="instance('como')/CO/ConcediuM/SalMinEC"/> lei</td>
				<td class="Tco7"><xforms:input class="inpVal" value="instance('como')/CO/ConcediuM/CASAt"/> %</td>
				<td class="Tco7"><b><xforms:output class="Tcoval7" value="instance('como')/CO/ConcediuM/ValCASAt"/></b></td>
				<td class="Tco7"><xforms:output class="Tcoval7" value="instance('como')/CO/ConcediuM/IndemCMBr"/></td>
				<td class="Tco7"><b><xforms:output class="Tcoval7" value="instance('como')/CO/ConcediuM/IndemPlCM"/></b></td>     
			</tr>

<!--	<tr >
		<td colspan="3" class="Tco10"><xforms:label class="conced">INDEMNIZATIA DE PLATA PRNTRU CONCEDIUL MEDICAL ESTE : </xforms:label></td> 
		<td colspan="2" class="Tco9"><b><xforms:output class="Tcoval7" ref="IndemPlCM"/></b></td>
    </tr>-->

		</xforms:group>
	</table>

<hr align="center" color="#D7D5D8" width="95%"/>

		<table align="center" border="0" cellspacing="2" cellpadding="0" width="95%"> 

				<tr>
					<tr>
						<td colspan="2" class="t7r1c4">Indemnizatia suportata de catre angajator<xforms:label/></td>						
						<td colspan="2" class="t7r1c4">Indemnizatia suportata de bugetul asigurarilor de sanatate pentru concedii si indemnizatii<xforms:label/></td>
						<td colspan="2" class="t7r1c4">Indemnizatia suportata de de fondul de asig pentruAccidente de munca si boli profesionale<xforms:label/></td>
					</tr>
					<tr>
						<td class="t7r1c4">Nr.Zile<xforms:label/></td>
						<td class="t7r1c4">lei<xforms:label/></td>
						<td class="t7r1c4">Nr.Zile<xforms:label/></td>
						<td class="t7r1c4">lei<xforms:label/></td>
						<td class="t7r1c4">Nr.Zile<xforms:label/></td>
						<td class="t7r1c4">lei<xforms:label/></td>
					</tr>	
					<tr>
						<td class="Tco7"><xforms:input class="inpVal" value="instance('como')/CO/ConcediuM/NrZCMSoc"/></td>
						<td class="Tco7"><xforms:input class="inp5" value="instance('como')/CO/ConcediuM/IndemSSoc"/></td>
						<td class="Tco7"><xforms:input class="inpVal" value="instance('como')/CO/ConcediuM/NrZCMBasci"/></td>
						<td class="Tco7"><xforms:input class="inp5" value="instance('como')/CO/ConcediuM/IndemSBASCI"/></td>
						<td class="Tco7"><xforms:input class="inpVal" value="instance('como')/CO/ConcediuM/NrZCMFaambp"/></td>
						<td class="Tco7"><xforms:input class="inp5" value="instance('como')/CO/ConcediuM/IndemSFAAMBP"/></td>
					</tr>
				</tr>

		</table>

		<hr align="center" color="#D7D5D8" width="95%"/>
				<div>
                    <xforms:trigger appearance="minimal">
                            <xforms:label class="medium button blue">&#164; Renunță &#164;</xforms:label>
						<xforms:hint>Renunta la modificare</xforms:hint>
                            <xforms:action ev:event="DOMActivate">
                            	<xforms:hide dialog="comed"/>
                            </xforms:action>
                    </xforms:trigger> 

					<xforms:trigger appearance="minimal">
						<xforms:label  class="medium button orange"><i>&#164; Salvează &#164;</i></xforms:label>  
						<xforms:hint>Salvează datele introduse/modificate</xforms:hint>	
							<xforms:action ev:event="DOMActivate">					
							<xforms:load resource="javascript:saveDataLocal('como')"/>					
						</xforms:action>
					</xforms:trigger> 

				</div>
			</div>
		</xforms:group> 
	</xforms:dialog>



<!-- ___________________Calculator concediu odihna______________________ -->



	<xforms:dialog id="codihna">
			<xforms:group nodeset="Salariat" ref="instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]/Salariat[@id=instance('tmp')/marca]"> 	
			<div align="center" style="width:85% ; padding:0px 0px 0px 40px;">
	<table align="center">
		<tr>
			<h4 align="center">CALCULATOR CONCEDIU ODIHNA</h4>  
			<td>An : </td>
			<td><b><xforms:output value="substring(instance('sal')/LunaLucru,5,2)" class="val3"/></b></td>
			<td> - Luna : </td>
			<td><b><xforms:output value="substring(instance('sal')/LunaLucru,1,4)" class="val3"/></b></td>
		</tr>
	</table>

	<div align="center" style="width:95% ; padding:0px 0px 0px 40px;">
		<table>
			<tr>
				<td>  
					<label>Societatea : </label><b>
					<xforms:output ref="instance('sal')/Date_firma/Prefix" class="val3"/>
					<xforms:output ref="instance('sal')/Date_firma/Firma" class="val2"/>
					<xforms:output ref="instance('sal')/Date_firma/Sufix" class="val3"/>
					</b></td>   
				<td>
					<label>CUI: RO </label><b>
					<xforms:output ref="instance('sal')/Date_firma/CISTVA" class="val2"/></b> 
			</td>
		</tr>
	</table>
	</div>
	
<br/>
   <!--<table  border="1" align="center" width="81%"> -->

<legend><b>FAZA I DE CALCUL</b> IN FUNCTIE DE VENITUL SI ZILELE LUCRATE PE ULTIMELE 3 LUNI <br/>INAINTE DE PLECAREA IN CONCEDIU CARE SUNT PRELUATE DIN ULTIMELE 3 STATE DE PLATA</legend>


<table border="0" cellspacing="0" cellpadding="5" width="100%">  
     <tr>
      <th class="Tco1">Explicatie</th>
      <th class="Tco2">Venit</th>
      <th class="Tco1">Explicatie</th>
      <th class="Tco2">Zile/Lucru</th>
   </tr>
</table>

<xforms:group>
 <table border="0" cellspacing="0" cellpadding="3" width="100%">    
     <tr>
   <td class="Tco3">Venit Luna I pentru Calcul CO : </td> 
   <td class="Tco4"><xforms:input class="Tcoval1" value="instance('como')/CO/ConcediuO/Luna1CO"/></td>
   <td class="Tco3">Zile licrate Luna I ptr.Calcul : </td>
      <td class="Tco16">
         <xforms:select1 value="instance('como')/CO/ConcediuO/ZileL1CO">  
                <xforms:item>
                    <xforms:label>23 ZileLucrate</xforms:label>
                    <xforms:value>23</xforms:value> 
                </xforms:item>

                <xforms:item>
                    <xforms:label>22 ZileLucrate</xforms:label>
                    <xforms:value>22</xforms:value>
                </xforms:item>

                <xforms:item>
                    <xforms:label>21 ZileLucrate</xforms:label>
                    <xforms:value>21</xforms:value>
                </xforms:item>

                <xforms:item>
                    <xforms:label>20 ZileLucrate</xforms:label>
                    <xforms:value>20</xforms:value>
                </xforms:item> 

               <xforms:item>
                    <xforms:label>19 ZileLucrate</xforms:label>
                    <xforms:value>19</xforms:value>
                </xforms:item> 
         </xforms:select1>
	</td>
   <!--<td class="Tco4"><xforms:input class="Tcoval1" value="instance('como')/CO/ConcediuO/ZileL1CO"/></td> -->
    </tr>
</table>

 <table border="0" cellspacing="0" cellpadding="3" width="100%"> 
      <tr>
   <td class="Tco3">Venit Luna II pentru Calcul CO : </td> 
   <td class="Tco4"><xforms:input class="Tcoval1" value="instance('como')/CO/ConcediuO/Luna2CO"/></td>
   <td class="Tco3">Zile licrate Luna II ptr.Calcul : </td> 
     <td class="Tco16">
         <xforms:select1 value="instance('como')/CO/ConcediuO/ZileL2CO">  
                <xforms:item>
                    <xforms:label>23 ZileLucrate</xforms:label>
                    <xforms:value>23</xforms:value> 
                </xforms:item>

                <xforms:item>
                    <xforms:label>22 ZileLucrate</xforms:label>
                    <xforms:value>22</xforms:value>
                </xforms:item>

                <xforms:item>
                    <xforms:label>21 ZileLucrate</xforms:label>
                    <xforms:value>21</xforms:value>
                </xforms:item>

                <xforms:item>
                    <xforms:label>20 ZileLucrate</xforms:label>
                    <xforms:value>20</xforms:value>
                </xforms:item> 

               <xforms:item>
                    <xforms:label>19 ZileLucrate</xforms:label>
                    <xforms:value>19</xforms:value>
                </xforms:item> 
         </xforms:select1>
	</td>
   <!--<td class="Tco4"><xforms:input class="Tcoval1" value="instance('como')/CO/ConcediuO/ZileL2CO"/></td>-->
    </tr>
</table>

 <table border="0" cellspacing="0" cellpadding="3" width="100%"> 
      <tr>
   <td class="Tco3">Venit Luna III pentru Calcul CO : </td> 
   <td class="Tco4"><xforms:input class="Tcoval1" value="instance('como')/CO/ConcediuO/Luna3CO"/></td>
   <td class="Tco3">Zile licrate Luna III ptr.Calcul : </td> 
     <td class="Tco16">
         <xforms:select1 value="instance('como')/CO/ConcediuO/ZileL3CO">  
                <xforms:item>
                    <xforms:label>23 ZileLucrate</xforms:label>
                    <xforms:value>23</xforms:value> 
                </xforms:item>

                <xforms:item>
                    <xforms:label>22 ZileLucrate</xforms:label>
                    <xforms:value>22</xforms:value>
                </xforms:item>

                <xforms:item>
                    <xforms:label>21 ZileLucrate</xforms:label>
                    <xforms:value>21</xforms:value>
                </xforms:item>

                <xforms:item>
                    <xforms:label>20 ZileLucrate</xforms:label>
                    <xforms:value>20</xforms:value>
                </xforms:item> 

               <xforms:item>
                    <xforms:label>19 ZileLucrate</xforms:label>
                    <xforms:value>19</xforms:value>
                </xforms:item> 
         </xforms:select1>
	</td>
   <!--<td class="Tco4"><xforms:input class="Tcoval1" value="instance('como')/CO/ConcediuO/ZileL3CO"/></td>-->
    </tr>
</table>
</xforms:group>

<hr/>

<xforms:group> 
 <table border="0" cellspacing="0" cellpadding="3" width="100%"> 
  
  <tr>
  <td class="Tco3">TOTAL VENIT PE ULTIMELE 3LUNI</td> 
  <td class="Tco4"><b><xforms:output class="Tcoval2" value="instance('como')/CO/ConcediuO/TVU3L"/></b></td>
  <td class="Tco3">TOTAL ZILE LUCRATE PE ULTIMELE 3LUNI</td> 
  <td class="Tco4"><b><xforms:output class="Tcoval2" value="instance('como')/CO/ConcediuO/TZU3L"/></b></td>
  </tr>

</table>  
 <table border="0" cellspacing="0" cellpadding="3" width="100%">    
    <tr>
      <th class="Tco5">Total venit pe ultimele 3luni-(1)</th>
      <th class="Tco5">Total zile lucrate pe ultimele 3luni-(2)</th>
      <th class="Tco7">Media salariala/zi in ultimele 3luni-(3)<br/>3=1/3 </th>
      <th class="Tco8">NR ZILE CONCEDIU DE ODIHNA-(5)</th> 
      <th class="Tco9">INDEMNIZATIA PENTRU CONCEDIU-(6)<br/>6=3*5</th>
   </tr>
</table>

 <table border="0" cellspacing="0" cellpadding="3" width="100%">   
  
    <tr>
      <td class="Tco15"><xforms:output class="Tcoval2" value="instance('como')/CO/ConcediuO/TVU3L"/></td>
      <td class="Tco15"><xforms:output class="Tcoval3" value="instance('como')/CO/ConcediuO/TZU3L"/></td>
      <td class="Tco17"><xforms:output class="Tcoval4" value="instance('como')/CO/ConcediuO/MedV3L"/></td>
      <td class="Tco18"><xforms:input class="Tcoval1" value="instance('como')/CO/ConcediuO/NrZCO"/></td>
      <td class="Tco19"><b><xforms:output class="Tcoval6" value="instance('como')/CO/ConcediuO/IndemCOF1"/></b></td>     
   </tr>

</table>
</xforms:group>

<br/>

<!-- <table  border="1" align="center" width="81%"> -->

     <legend><b>FAZA II DE CALCUL</b> IN FUNCTIE DE SALARIUL DE BAZA DIN LUNA CURENTA</legend>
 <table border="0" cellspacing="0" cellpadding="5" width="100%">    
    <tr>
      <th class="Tco6">Venit salarial luna curenta</th>
      <th class="Tco6">Total zile lucratoare luna curenta</th>
      <th class="Tco7">Media salariala/zi luna curenta</th>
      <th class="Tco8">NR ZILE CONCEDIU DE ODIHNA</th> 
      <th class="Tco9">INDEMNIZATIA PENTRU CONCEDIU</th>
   </tr> 
</table>

<xforms:group> 
<table border="0" cellspacing="0" cellpadding="3" width="100%">   
 
    <tr>
      <td class="Tco15"><xforms:input class="Tcoval1" value="instance('como')/CO/ConcediuO/SalariuLC"/></td>
     <td class="Tco16">
         <xforms:select1 value="instance('como')/CO/ConcediuO/NrZLC">  
                <xforms:item>
                    <xforms:label>23 ZileLucratoare</xforms:label>
                    <xforms:value>23</xforms:value> 
                </xforms:item>

                <xforms:item>
                    <xforms:label>22 ZileLucratoare</xforms:label>
                    <xforms:value>22</xforms:value>
                </xforms:item>

                <xforms:item>
                    <xforms:label>21 ZileLucratoare</xforms:label>
                    <xforms:value>21</xforms:value>
                </xforms:item>

                <xforms:item>
                    <xforms:label>20 ZileLucratoare</xforms:label>
                    <xforms:value>20</xforms:value>
                </xforms:item> 

               <xforms:item>
                    <xforms:label>19 ZileLucratoare</xforms:label>
                    <xforms:value>19</xforms:value>
                </xforms:item> 
         </xforms:select1>
	</td>
      <!--<td class="Tco6"><xforms:input class="Tcoval1" ref="NrZLC"/></td>-->
      <td class="Tco17"><xforms:output class="Tcoval4" value="instance('como')/CO/ConcediuO/MedVZLc"/></td>
      <td class="Tco18"><xforms:output class="Tcoval5" value="instance('como')/CO/ConcediuO/NrZCO"/></td>
      <td class="Tco19"><b><xforms:output class="Tcoval6" value="instance('como')/CO/ConcediuO/IndemCOF2"/></b></td>     
   </tr>
</table>
<hr/>
 <table border="0" cellspacing="0" cellpadding="3" width="100%"> 
      <tr>
   <td class="Tco9"><xforms:label class="conced">INDEMNIZATIA DE PLATA PRNTRU CONCEDIUL DE ODIHNA ESTE : </xforms:label></td> 
   <td class="Tco9"><b><xforms:output class="Tcoval7" value="instance('como')/CO/ConcediuO/IndemPlCO"/></b></td>
    </tr>
</table>
</xforms:group>


				<div>
                    <xforms:trigger appearance="minimal">
                            <xforms:label class="medium button blue">&#164; Renunță &#164;</xforms:label>
						<xforms:hint>Renunta la modificare</xforms:hint>
                            <xforms:action ev:event="DOMActivate">
                            	<xforms:hide dialog="codihna"/>
                            </xforms:action>
                    </xforms:trigger> 

					<xforms:trigger appearance="minimal">
						<xforms:label  class="medium button orange"><i>&#164; Salvează &#164;</i></xforms:label>  
						<xforms:hint>Salvează datele introduse/modificate</xforms:hint>	
							<xforms:action ev:event="DOMActivate">					
							<xforms:load resource="javascript:saveDataLocal('como')"/>					
						</xforms:action>
					</xforms:trigger>
				</div>
			</div>
		</xforms:group> 
	</xforms:dialog>		 
	<!-- Dialog COCM  end -->

		<xforms:dialog id="ConfirmDelete">	
		    <div>
				<div style="padding:1em;">Vor fi șterse toate înregistrările din această lună. Datele șterse nu se mai pot recupera 						</div>
		    	<br/>  
		        <span style="padding:1em;">
		            <xforms:trigger appearance="minimal">
		            <xforms:label class="small button red"> Șterge </xforms:label>
		                <xforms:action ev:event="DOMActivate">
		                    <xforms:delete nodeset="instance('sal')/DateLunare/Luna[@AnLuna = instance('sal')/LunaLucru]"/>
		                    <xforms:load resource="javascript:saveDataLocal('sal')"/>
		                    <xforms:hide dialog="ConfirmDelete" />
		                </xforms:action>
		            </xforms:trigger>
	            </span>
	            <span style="padding:1em;">
		            <xforms:trigger>
		                <xforms:label class="Home"> Renunță </xforms:label>
		                <xforms:action ev:event="DOMActivate">
		                	<xforms:hide dialog="ConfirmDelete" />
		                </xforms:action>	
		            </xforms:trigger>
		        </span>
		    </div>
		</xforms:dialog>	<!-- End dialog "ConfirmDelete" -->        
    </body>
</html>

